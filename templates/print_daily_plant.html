<!DOCTYPE html>
<html>
<head>
  <title>LAPS â€“ Daily Line Allocation</title>

  <!-- Bootstrap only for table normalization -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    /* ======================================================
       PRINT-FIRST DESIGN
       ====================================================== */

    @page {
      size: A4;
      margin: 14mm;
    }

    body {
      font-family: Arial, Helvetica, sans-serif;
      font-size: 12.5px;
      color: #000;
    }

    h1 {
      font-size: 18px;
      margin-bottom: 6px;
    }

    h2 {
      font-size: 15px;
      margin: 0;
    }

    .meta {
      font-size: 12px;
      margin-bottom: 10px;
    }

    .meta span {
      margin-right: 16px;
    }

    .summary-box {
      border: 1px solid #000;
      padding: 8px;
      margin-bottom: 12px;
    }

    .summary-grid {
      display: flex;
      justify-content: space-between;
      font-weight: bold;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 6px;
    }

    th, td {
      border: 1px solid #000;
      padding: 6px;
      vertical-align: top;
    }

    th {
      background: #eaeaea;
      text-align: center;
      font-weight: bold;
    }

    td {
      font-size: 12px;
    }

    .op-col {
      width: 7%;
      font-weight: bold;
      text-align: center;
    }

    .time-col {
      width: 12%;
      text-align: center;
      font-weight: bold;
    }

    .status-col {
      width: 10%;
      text-align: center;
      font-weight: bold;
    }

    .status-ok {
      background: #e6ffe6;
    }

    .status-over {
      background: #ffe6e6;
    }

    .status-under {
      background: #fff3e0;
    }

    ol {
      margin: 0;
      padding-left: 16px;
    }

    li {
      margin-bottom: 3px;
    }

    .legend {
      font-size: 11.5px;
      margin-top: 6px;
    }

    .page-break {
      page-break-after: always;
    }

    /* Remove anything interactive */
    button, a {
      display: none !important;
    }

  </style>
</head>

<body>

<h1>Daily Line Allocation</h1>

{% for r in result %}
<!-- ======================================================
     LINE HEADER
====================================================== -->
<div class="meta">
  <span><strong>Line:</strong> {{ r.line }}</span>
  <span><strong>Plan Qty:</strong> {{ r.plan }}</span>
  <span><strong>Takt:</strong> {{ r.takt }} sec</span>
  <span><strong>Manpower:</strong> {{ r.manpower_used }}</span>
</div>

<!-- ======================================================
     SUMMARY
====================================================== -->
<div class="summary-box">
  <div class="summary-grid">
    <div>Total Work Content: {{ r.wc }} sec</div>
    <div>Shift: {{ r.shift }} min</div>
  </div>
</div>

<!-- ======================================================
     ALLOCATION TABLE
====================================================== -->
<table>
  <thead>
    <tr>
      <th class="op-col">OP</th>
      <th>Assigned Activities</th>
      <th class="time-col">Time (sec)</th>
      <th class="status-col">Status</th>
    </tr>
  </thead>
  <tbody>
  {% for op in r.operators %}
    <tr class="
      {% if op.status == 'over' %}
        status-over
      {% elif op.status == 'under' %}
        status-under
      {% else %}
        status-ok
      {% endif %}
    ">
      <td class="op-col">{{ op.name }}</td>

      <td>
        <ol>
          {% for a in op.acts %}
            <li>{{ a.text }}</li>
          {% endfor %}
        </ol>
      </td>

      <td class="time-col">{{ op.time }}</td>

      <td class="status-col">
        {% if op.status == 'over' %}OVER
        {% elif op.status == 'under' %}UNDER
        {% else %}OK{% endif %}
      </td>
    </tr>
  {% endfor %}
  </tbody>
</table>

<div class="legend">
  <strong>Legend:</strong>
  OK = Within Takt |
  OVER = Bottleneck |
  UNDER = Underutilized
</div>

<div class="page-break"></div>
{% endfor %}

</body>
</html>
